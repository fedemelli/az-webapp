<h2>Azure Cost Management + Billing</h2>
<p><strong>Cost Management + Billing</strong> √® la suite di strumenti nativi Azure per monitorare, analizzare e ottimizzare la spesa cloud. Permette alle organizzazioni di adottare pratiche <strong>FinOps</strong> per massimizzare il valore del cloud.</p>

<!-- Diagramma Cost Flow -->
<svg viewBox="0 0 600 220" style="width:100%;max-width:600px;margin:24px auto;display:block;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);border-radius:16px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
  <defs>
    <linearGradient id="costGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0ea5e9"/>
      <stop offset="100%" style="stop-color:#3b82f6"/>
    </linearGradient>
  </defs>
  <!-- Ingestion -->
  <rect x="50" y="60" width="100" height="80" rx="8" fill="white" stroke="#cbd5e1" stroke-width="2"/>
  <text x="100" y="95" fill="#1e293b" font-size="12" text-anchor="middle" font-weight="bold">Usage Data</text>
  <text x="100" y="115" fill="#64748b" font-size="10" text-anchor="middle">Azure, M365</text>
  
  <!-- Arrow -->
  <path d="M150 100 L190 100" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Engine -->
  <circle cx="240" cy="100" r="40" fill="url(#costGrad)"/>
  <text x="240" y="95" fill="white" font-size="10" text-anchor="middle" font-weight="bold">Cost Admin</text>
  <text x="240" y="115" fill="white" font-size="10" text-anchor="middle">Engine</text>
  
  <!-- Arrow -->
  <path d="M280 100 L320 100" stroke="#94a3b8" stroke-width="2"/>
  
  <!-- Outputs -->
  <rect x="320" y="30" width="120" height="40" rx="6" fill="#ecfdf5" stroke="#10b981" stroke-width="2"/>
  <text x="380" y="55" fill="#047857" font-size="11" text-anchor="middle" font-weight="bold">Cost Analysis</text>
  
  <rect x="320" y="80" width="120" height="40" rx="6" fill="#fff7ed" stroke="#f97316" stroke-width="2"/>
  <text x="380" y="105" fill="#c2410c" font-size="11" text-anchor="middle" font-weight="bold">Budgets & Alerts</text>
  
  <rect x="320" y="130" width="120" height="40" rx="6" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <text x="380" y="155" fill="#1d4ed8" font-size="11" text-anchor="middle" font-weight="bold">Exports (PowerBI)</text>
  
  <!-- Scopes -->
  <rect x="480" y="40" width="80" height="120" rx="8" fill="#f1f5f9" stroke="#94a3b8" stroke-dasharray="4"/>
  <text x="520" y="60" fill="#475569" font-size="10" text-anchor="middle" font-weight="bold">Scopes</text>
  <text x="520" y="80" fill="#64748b" font-size="9" text-anchor="middle">Mgmt Group</text>
  <text x="520" y="100" fill="#64748b" font-size="9" text-anchor="middle">Subscription</text>
  <text x="520" y="120" fill="#64748b" font-size="9" text-anchor="middle">Resource Grp</text>
</svg>

<h3>Cost Analysis Views</h3>
<p>Lo strumento principale per visualizzare i costi. Puoi personalizzare la vista raggruppando e filtrando i dati.</p>

<div style="overflow-x:auto;margin:20px 0;">
  <table style="width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
    <thead>
      <tr style="background:linear-gradient(135deg,#0284c7,#0369a1);">
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Vista</th>
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Descrizione</th>
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Use Case</th>
      </tr>
    </thead>
    <tbody>
      <tr style="background:#f0f9ff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#0369a1;">Accumulated Costs</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Grafico ad area che mostra la crescita della spesa nel mese</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Monitorare il trend mensile rispetto al budget</td>
      </tr>
      <tr style="background:#ffffff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#0369a1;">Cost by Service</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Tabella/Grafico a torta per categoria di servizio (es. Storage, Compute)</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Identificare i servizi "spendaccioni"</td>
      </tr>
      <tr style="background:#f0f9ff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#0369a1;">Cost by Resource</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Dettaglio granulare per singola risorsa</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Analisi approfondita su risorse specifiche</td>
      </tr>
       <tr style="background:#ffffff;">
        <td style="padding:12px 16px;font-weight:600;color:#0369a1;">Invoice Details</td>
        <td style="padding:12px 16px;">Vista tabellare allineata con la fattura mensile</td>
        <td style="padding:12px 16px;">Riconciliazione fatture</td>
      </tr>
    </tbody>
  </table>
</div>

<h3>Raggruppamenti e Filtri (Scopes)</h3>
<p>La potenza di Cost Management sta nella capacit√† di "tagliare" i dati. I raggruppamenti pi√π comuni:</p>

<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin:20px 0;">
  <div style="background:white;border-left:4px solid #3b82f6;border-radius:10px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,0.1);">
    <h4 style="margin:0 0 8px 0;color:#1e40af;font-size:15px;">Organizzativo</h4>
    <p style="margin:0;color:#475569;font-size:13px;">Management Group, Subscription, Resource Group. Utile per chargeback dipartimentale.</p>
  </div>
  <div style="background:white;border-left:4px solid #ec4899;border-radius:10px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,0.1);">
    <h4 style="margin:0 0 8px 0;color:#be185d;font-size:15px;">Tags</h4>
    <p style="margin:0;color:#475569;font-size:13px;">Raggruppa per tag personalizzati (es. <code>Project: Website</code>, <code>Env: Prod</code>). Fondamentale per attribuzione costi trasversale.</p>
  </div>
  <div style="background:white;border-left:4px solid #10b981;border-radius:10px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,0.1);">
    <h4 style="margin:0 0 8px 0;color:#047857;font-size:15px;">Location & Meter</h4>
    <p style="margin:0;color:#475569;font-size:13px;">Analizza costi per Region (es. West Europe) o categoria di contatore (es. Bandwidth, Disk Operations).</p>
  </div>
</div>

<h3>Export Automatici</h3>
<p>Per analisi avanzate o backup dei dati di fatturazione, puoi configurare <strong>Exports</strong> schedulati.</p>
<ul style="border: 2px solid #e2e8f0; border-radius: 12px; padding: 20px 40px; background: #f8fafc;">
    <li style="margin-bottom: 10px;"><strong>Destinazione:</strong> Azure Storage Account (Blob Container).</li>
    <li style="margin-bottom: 10px;"><strong>Formato:</strong> CSV (spesso file di grandi dimensioni).</li>
    <li style="margin-bottom: 10px;"><strong>Frequenza:</strong> Giornaliera, Settimanale, Mensile, One-time.</li>
    <li><strong>Utilizzo:</strong> Importazione in Power BI, Excel o integrazione con sistemi ERP aziendali.</li>
</ul>

<h3>CLI Quick Reference</h3>
<div style="background:linear-gradient(135deg,#1e293b,#0f172a);border-radius:12px;padding:20px;margin:20px 0;overflow-x:auto;">
  <pre style="margin:0;color:#e2e8f0;font-size:13px;line-height:1.6;font-family:'Consolas','Monaco',monospace;"><code><span style="color:#94a3b8;"># Visualizzare usage corrente (tabella)</span>
<span style="color:#38bdf8;">az consumption usage list</span> <span style="color:#fbbf24;">--output</span> table

<span style="color:#94a3b8;"># Esportare usage top 5 in formato JSON</span>
<span style="color:#38bdf8;">az consumption usage list</span> <span style="color:#fbbf24;">--top</span> 5 <span style="color:#fbbf24;">--output</span> json

<span style="color:#94a3b8;"># Visualizzare i prezzi retail per una VM (utile per stime)</span>
<span style="color:#38bdf8;">az consumption pricesheet show</span> <span style="color:#fbbf24;">--filter</span> "meterDetails/meterName eq 'D2s v3'"</code></pre>
</div>

<!-- Callout esame -->
<div style="background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-left:4px solid #3b82f6;border-radius:12px;padding:20px;margin-top:24px;">
  <div style="display:flex;align-items:flex-start;gap:12px;">
    <span style="font-size:24px;">üìù</span>
    <div>
      <strong style="color:#1e40af;font-size:15px;">Tips per l'Esame AZ-104</strong>
      <ul style="margin:8px 0 0 0;padding-left:20px;color:#1e3a8a;font-size:14px;">
        <li>Conoscere la differenza tra <strong>Cost Analysis</strong> (visualizzazione interattiva) e <strong>Exports</strong> (raw data dump).</li>
        <li>Ricorda che i <strong>Tags</strong> non sono retroattivi per la reportistica storica precedente alla loro applicazione.</li>
        <li>I permessi: <strong>Cost Management Reader</strong> vede i costi, <strong>Contributor</strong> crea budget/export.</li>
      </ul>
    </div>
  </div>
</div>