<h2>Azure Managed Disks</h2>
<p>I <strong>Managed Disks</strong> sono la soluzione raccomandata per lo storage persistente delle VM Azure. Azure
  gestisce automaticamente l'infrastruttura di storage sottostante.</p>

<!-- Diagramma architettura dischi -->
<svg viewBox="0 0 600 200"
  style="width:100%;max-width:600px;margin:24px auto;display:block;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);border-radius:16px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
  <defs>
    <linearGradient id="diskGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1" />
      <stop offset="100%" style="stop-color:#8b5cf6" />
    </linearGradient>
    <linearGradient id="diskGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b" />
      <stop offset="100%" style="stop-color:#f97316" />
    </linearGradient>
  </defs>
  <!-- VM Box -->
  <rect x="20" y="40" width="120" height="120" rx="12" fill="url(#diskGrad1)" />
  <text x="80" y="80" fill="white" font-size="11" text-anchor="middle" font-weight="bold">Virtual</text>
  <text x="80" y="95" fill="white" font-size="11" text-anchor="middle" font-weight="bold">Machine</text>
  <text x="80" y="130" fill="rgba(255,255,255,0.8)" font-size="9" text-anchor="middle">vCPU + RAM</text>
  <!-- Arrow -->
  <path d="M150 100 L190 100" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)" />
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
    </marker>
  </defs>
  <!-- Disks Container -->
  <rect x="200" y="20" width="380" height="160" rx="12" fill="white" stroke="#e2e8f0" stroke-width="2" />
  <text x="390" y="45" fill="#1e293b" font-size="12" text-anchor="middle" font-weight="bold">Managed Disks</text>
  <!-- OS Disk -->
  <rect x="220" y="60" width="100" height="100" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2" />
  <text x="270" y="100" fill="#1e40af" font-size="10" text-anchor="middle" font-weight="bold">OS Disk</text>
  <text x="270" y="115" fill="#3b82f6" font-size="8" text-anchor="middle">(obbligatorio)</text>
  <text x="270" y="140" fill="#64748b" font-size="8" text-anchor="middle">Windows/Linux</text>
  <!-- Data Disks -->
  <rect x="340" y="60" width="100" height="100" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" />
  <text x="390" y="100" fill="#92400e" font-size="10" text-anchor="middle" font-weight="bold">Data Disk 1</text>
  <text x="390" y="115" fill="#f59e0b" font-size="8" text-anchor="middle">(opzionale)</text>
  <rect x="460" y="60" width="100" height="100" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" />
  <text x="510" y="100" fill="#92400e" font-size="10" text-anchor="middle" font-weight="bold">Data Disk N</text>
  <text x="510" y="115" fill="#f59e0b" font-size="8" text-anchor="middle">(opzionale)</text>
</svg>

<h3>Tipi di Disco a Confronto</h3>
<div style="overflow-x:auto;margin:20px 0;">
  <table
    style="width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
    <thead>
      <tr style="background:linear-gradient(135deg,#4f46e5,#7c3aed);">
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Tipo Disco</th>
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Max IOPS</th>
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Max Throughput</th>
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Use Case</th>
      </tr>
    </thead>
    <tbody>
      <tr style="background:#faf5ff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#7c3aed;">Ultra Disk</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">160.000</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">4.000 MB/s</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">SAP HANA, SQL tier-1, Mission-critical</td>
      </tr>
      <tr style="background:#f5f3ff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#6366f1;">Premium SSD v2</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">80.000</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">1.200 MB/s</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">IOPS/throughput configurabili indipendentemente
        </td>
      </tr>
      <tr style="background:#eff6ff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#3b82f6;">Premium SSD</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">20.000</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">900 MB/s</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Produzione, database</td>
      </tr>
      <tr style="background:#f0fdf4;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#16a34a;">Standard SSD</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">6.000</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">750 MB/s</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;">Web server, Dev/Test</td>
      </tr>
      <tr style="background:#fefce8;">
        <td style="padding:12px 16px;font-weight:600;color:#ca8a04;">Standard HDD</td>
        <td style="padding:12px 16px;">2.000</td>
        <td style="padding:12px 16px;">500 MB/s</td>
        <td style="padding:12px 16px;">Backup, archivio, accesso infrequente</td>
      </tr>
    </tbody>
  </table>
</div>

<h3>Opzioni di Crittografia</h3>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin:20px 0;">
  <div
    style="background:linear-gradient(135deg,#eff6ff,#dbeafe);border-left:4px solid #3b82f6;border-radius:12px;padding:20px;">
    <h4 style="margin:0 0 8px 0;color:#1e40af;font-size:15px;">SSE - Server-Side Encryption</h4>
    <ul style="margin:0;padding-left:20px;color:#334155;font-size:14px;">
      <li><strong>Sempre attiva</strong> di default</li>
      <li>Encryption at rest con chiavi Microsoft</li>
      <li>Opzione: Customer-managed keys (CMK)</li>
      <li>Nessun impatto sulle performance</li>
    </ul>
  </div>
  <div
    style="background:linear-gradient(135deg,#fef3c7,#fde68a);border-left:4px solid #f59e0b;border-radius:12px;padding:20px;">
    <h4 style="margin:0 0 8px 0;color:#92400e;font-size:15px;">ADE - Azure Disk Encryption</h4>
    <ul style="margin:0;padding-left:20px;color:#334155;font-size:14px;">
      <li><strong>BitLocker</strong> per Windows</li>
      <li><strong>DM-Crypt</strong> per Linux</li>
      <li>Chiavi in Azure Key Vault</li>
      <li>Encryption in-guest per compliance</li>
    </ul>
  </div>
  <div
    style="background:linear-gradient(135deg,#f0fdf4,#dcfce7);border-left:4px solid #16a34a;border-radius:12px;padding:20px;">
    <h4 style="margin:0 0 8px 0;color:#166534;font-size:15px;">Encryption at Host</h4>
    <ul style="margin:0;padding-left:20px;color:#334155;font-size:14px;">
      <li>Crittografia end-to-end</li>
      <li>Include temp disk e cache</li>
      <li>Dati cifrati dal compute host</li>
      <li>Richiede abilitazione feature</li>
    </ul>
  </div>
</div>

<h3>Comandi CLI per Managed Disks</h3>
<div
  style="background:linear-gradient(135deg,#1e293b,#0f172a);border-radius:12px;padding:20px;margin:20px 0;overflow-x:auto;">
  <pre style="margin:0;color:#e2e8f0;font-size:13px;line-height:1.6;font-family:'Consolas','Monaco',monospace;"><code><span style="color:#94a3b8;"># Creare un disco managed</span>
<span style="color:#38bdf8;">az disk create</span> <span style="color:#fbbf24;">--name</span> MyDataDisk <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--resource-group</span> MyRG <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--size-gb</span> 128 <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--sku</span> Premium_LRS

<span style="color:#94a3b8;"># Collegare disco a una VM</span>
<span style="color:#38bdf8;">az vm disk attach</span> <span style="color:#fbbf24;">--vm-name</span> MyVM <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--resource-group</span> MyRG <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--disk</span> MyDataDisk <span style="color:#fbbf24;">--new</span>

<span style="color:#94a3b8;"># Ridimensionare un disco (VM must be stopped)</span>
<span style="color:#38bdf8;">az disk update</span> <span style="color:#fbbf24;">--name</span> MyDataDisk <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--resource-group</span> MyRG <span style="color:#a78bfa;">\\</span>
  <span style="color:#fbbf24;">--size-gb</span> 256</code></pre>
</div>

<h3>Disk SKU e Ridondanza</h3>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin:20px 0;">
  <div style="background:white;border:2px solid #e2e8f0;border-radius:10px;padding:16px;text-align:center;">
    <div style="font-weight:700;color:#4f46e5;font-size:16px;">LRS</div>
    <div style="color:#64748b;font-size:12px;margin-top:4px;">Locally Redundant</div>
    <div style="color:#334155;font-size:11px;margin-top:8px;">3 copie in un datacenter</div>
  </div>
  <div style="background:white;border:2px solid #e2e8f0;border-radius:10px;padding:16px;text-align:center;">
    <div style="font-weight:700;color:#0891b2;font-size:16px;">ZRS</div>
    <div style="color:#64748b;font-size:12px;margin-top:4px;">Zone Redundant</div>
    <div style="color:#334155;font-size:11px;margin-top:8px;">3 copie su 3 zone</div>
  </div>
</div>

<!-- Callout esame -->
<!-- Callout esame -->
<div
  style="background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-left:4px solid #3b82f6;border-radius:12px;padding:20px;margin-top:24px;">
  <div style="display:flex;align-items:flex-start;gap:12px;">
    <span style="font-size:24px;">üìù</span>
    <div>
      <strong style="color:#1e40af;font-size:15px;">Tips per l'Esame AZ-104</strong>
      <ul style="margin:8px 0 0 0;padding-left:20px;color:#1e3a8a;font-size:14px;">
        <li>Per aumentare la dimensione (Size) di un disco, la VM deve essere <strong>Deallocata</strong> (Stopped).
        </li>
        <li>Puoi solo <strong>aumentare</strong> la dimensione di un disco, MAI ridurla.</li>
        <li><strong>Ultra Disk</strong> richiede Reservation e VM compatibili (Availability Zone obbligatoria).</li>
        <li><strong>SSE</strong> (Server Side Encryption) √® on by default. <strong>ADE</strong> (Azure Disk Encryption)
          usa BitLocker/DM-Crypt e richiede un Key Vault.</li>
      </ul>
    </div>
  </div>
</div>