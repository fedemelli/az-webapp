<h2>Replication & Redundancy</h2>
<p>Azure garantisce la durabilit√† dei dati replicandoli multiple volte. Scegliere la giusta strategia di replica √®
  critico per High Availability (HA) e Disaster Recovery (DR).</p>

<!-- Diagramma Redundancy -->
<svg viewBox="0 0 600 320"
  style="width:100%;max-width:600px;margin:24px auto;display:block;background:white;border-radius:16px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);border:1px solid #e2e8f0;">
  <defs>
    <style>
      .data-block {
        fill: #3b82f6;
        stroke: #1e40af;
        stroke-width: 1;
      }

      .zone-box {
        fill: #f8fafc;
        stroke: #cbd5e1;
        stroke-width: 1;
        stroke-dasharray: 4;
      }

      .region-box {
        fill: #f1f5f9;
        stroke: #94a3b8;
        stroke-width: 2;
      }

      .label {
        font-size: 10px;
        fill: #475569;
        font-family: sans-serif;
        text-anchor: middle;
      }

      .title {
        font-weight: bold;
        font-family: sans-serif;
        fill: #0f172a;
      }
    </style>
  </defs>

  <!-- LRS Section -->
  <g transform="translate(20, 20)">
    <text x="70" y="20" class="title" text-anchor="middle">LRS (Locally)</text>
    <rect x="0" y="30" width="140" height="100" class="region-box" />
    <text x="70" y="45" class="label">Primary Region</text>

    <rect x="20" y="60" width="100" height="60" rx="4" fill="white" stroke="#cbd5e1" />
    <text x="70" y="75" class="label">Single DC</text>

    <!-- 3 Copies -->
    <rect x="35" y="90" width="20" height="20" class="data-block" />
    <rect x="60" y="90" width="20" height="20" class="data-block" />
    <rect x="85" y="90" width="20" height="20" class="data-block" />
  </g>

  <!-- ZRS Section -->
  <g transform="translate(180, 20)">
    <text x="100" y="20" class="title" text-anchor="middle">ZRS (Zone)</text>
    <rect x="0" y="30" width="200" height="100" class="region-box" />
    <text x="100" y="45" class="label">Primary Region (3 AZs)</text>

    <!-- Zone 1 -->
    <rect x="10" y="60" width="50" height="60" class="zone-box" />
    <rect x="25" y="80" width="20" height="20" class="data-block" />

    <!-- Zone 2 -->
    <rect x="75" y="60" width="50" height="60" class="zone-box" />
    <rect x="90" y="80" width="20" height="20" class="data-block" />

    <!-- Zone 3 -->
    <rect x="140" y="60" width="50" height="60" class="zone-box" />
    <rect x="155" y="80" width="20" height="20" class="data-block" />
  </g>

  <!-- GRS Section -->
  <g transform="translate(20, 160)">
    <text x="140" y="20" class="title" text-anchor="middle">GRS (Geo-Redundant)</text>

    <!-- Primary -->
    <rect x="0" y="30" width="120" height="100" class="region-box" />
    <text x="60" y="45" class="label">Primary Region</text>
    <rect x="30" y="60" width="60" height="60" fill="white" stroke="#cbd5e1" stroke-dasharray="2" />
    <text x="60" y="80" class="label" font-size="8">LRS (3 copies)</text>
    <rect x="40" y="90" width="40" height="20" class="data-block" />

    <!-- Arrow -->
    <path d="M130 80 L190 80" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="4" />
    <text x="160" y="70" class="label" font-size="9">Async Copy</text>

    <!-- Secondary -->
    <rect x="200" y="30" width="120" height="100" class="region-box" />
    <text x="260" y="45" class="label">Secondary Region</text>
    <rect x="230" y="60" width="60" height="60" fill="white" stroke="#cbd5e1" stroke-dasharray="2" />
    <text x="260" y="80" class="label" font-size="8">LRS (3 copies)</text>
    <rect x="240" y="90" width="40" height="20" class="data-block" style="fill:#93c5fd" />
  </g>

  <!-- GZRS Section -->
  <g transform="translate(360, 160)">
    <text x="100" y="20" class="title" text-anchor="middle">GZRS (Geo-Zone)</text>
    <text x="100" y="80" class="label" font-style="italic">Combines ZRS in Primary + LRS in Secondary</text>
    <text x="100" y="100" class="label" font-weight="bold">= Max Durability</text>
  </g>
</svg>

<h3>Confronto Scenari di Guasto</h3>
<div style="overflow-x:auto;margin:20px 0;">
  <table
    style="width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
    <thead>
      <tr style="background:linear-gradient(135deg,#4338ca,#3730a3);">
        <th style="padding:14px 16px;text-align:left;color:white;font-weight:600;">Scenario</th>
        <th style="padding:14px 16px;text-align:center;color:white;font-weight:600;">LRS</th>
        <th style="padding:14px 16px;text-align:center;color:white;font-weight:600;">ZRS</th>
        <th style="padding:14px 16px;text-align:center;color:white;font-weight:600;">GRS</th>
        <th style="padding:14px 16px;text-align:center;color:white;font-weight:600;">GZRS</th>
      </tr>
    </thead>
    <tbody>
      <tr style="background:#eef2ff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#3730a3;">Disk/Node Failure
        </td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#16a34a;">‚úÖ</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#16a34a;">‚úÖ</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#16a34a;">‚úÖ</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#16a34a;">‚úÖ</td>
      </tr>
      <tr style="background:#ffffff;">
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;font-weight:600;color:#3730a3;">Datacenter Fire
          (Zone)</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#dc2626;">‚ùå</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#16a34a;">‚úÖ</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#dc2626;">‚ùå*</td>
        <td style="padding:12px 16px;border-bottom:1px solid #e2e8f0;text-align:center;color:#16a34a;">‚úÖ</td>
      </tr>
      <tr style="background:#eef2ff;">
        <td style="padding:12px 16px;font-weight:600;color:#3730a3;">Region Failure (Disaster)</td>
        <td style="padding:12px 16px;text-align:center;color:#dc2626;">‚ùå</td>
        <td style="padding:12px 16px;text-align:center;color:#dc2626;">‚ùå</td>
        <td style="padding:12px 16px;text-align:center;color:#16a34a;">‚úÖ</td>
        <td style="padding:12px 16px;text-align:center;color:#16a34a;">‚úÖ</td>
      </tr>
    </tbody>
  </table>
  <p style="font-size:11px;color:#64748b;margin:8px 16px;">* GRS protegge dalla perdita dati in caso di Region Failure,
    ma se perdi il singolo DC primario (senza perdere l'intera region) potresti avere indisponibilit√† temporanea.</p>
</div>

<h3>Failover e Read Access</h3>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin:20px 0;">
  <div
    style="background:white;border-left:4px solid #f59e0b;border-radius:10px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,0.1);">
    <h4 style="margin:0 0 8px 0;color:#d97706;font-size:15px;">RA-GRS (Read Access)</h4>
    <p style="margin:0;color:#475569;font-size:13px;">Abilita la <strong>lettura</strong> sulla regione secondaria
      SEMPRE, anche se la primaria √® online. Utile per applicazioni High Availability in lettura.</p>
  </div>
  <div
    style="background:white;border-left:4px solid #dc2626;border-radius:10px;padding:16px;box-shadow:0 1px 3px rgba(0,0,0,0.1);">
    <h4 style="margin:0 0 8px 0;color:#b91c1c;font-size:15px;">Customer-Managed Failover</h4>
    <p style="margin:0;color:#475569;font-size:13px;">Se la primaria cade, PUOI forzare il failover manualmente.
      <strong>Attenzione:</strong> Poich√© la copia √® asincrona, potresti perdere gli ultimi dati scritti (RPO > 0).
    </p>
  </div>
</div>

<h3>Durabilit√†</h3>
<ul>
  <li><strong>LRS</strong>: 99.999999999% (11 nines)</li>
  <li><strong>ZRS</strong>: 99.9999999999% (12 nines)</li>
  <li><strong>GRS</strong>: 16 nines</li>
</ul>

<!-- Callout esame -->
<div
  style="background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-left:4px solid #3b82f6;border-radius:12px;padding:20px;margin-top:24px;">
  <div style="display:flex;align-items:flex-start;gap:12px;">
    <span style="font-size:24px;">üìù</span>
    <div>
      <strong style="color:#1e40af;font-size:15px;">Tips per l'Esame AZ-104</strong>
      <ul style="margin:8px 0 0 0;padding-left:20px;color:#1e3a8a;font-size:14px;">
        <li>Se la domanda richiede <strong>High Availability (HA)</strong> in caso di guasto datacenter ->
          <strong>ZRS</strong>.</li>
        <li>Se richiede <strong>Disaster Recovery (DR)</strong> regionale ma con costi minimi -> <strong>GRS</strong>.
        </li>
        <li>Se l'applicazione deve leggere dalla secondaria sempre (non solo dopo failover) -> <strong>RA-GRS</strong> o
          <strong>RA-GZRS</strong>.</li>
        <li>Il failover manuale (Customer-managed) modifica il record DNS e trasforma l'account in <strong>LRS</strong>.
        </li>
      </ul>
    </div>
  </div>
</div>